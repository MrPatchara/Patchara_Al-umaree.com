const CACHE_NAME='patchara-v1';const urlsToCache=['./','.*/index.html','./templatemo-prism-flux.min.css','./templatemo-prism-scripts.min.js','./images/','./api/'];self.addEventListener('install',e=>{e.waitUntil(caches.open(CACHE_NAME).then(e=>e.addAll(['./','/index.html','/templatemo-prism-flux.min.css','/templatemo-prism-scripts.min.js']).catch(e=>console.log('Cache addAll error:',e))))}),self.addEventListener('activate',e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>e!==CACHE_NAME&&caches.delete(e)))))}),self.addEventListener('fetch',e=>{const t=e.request;'GET'===t.method&&(e.respondWith(caches.match(t).then(r=>{if(r)return r;const a=t.clone();return fetch(a).then(r=>{if(!r||400===r.status||500===r.status)return r;const i=r.clone();return caches.open(CACHE_NAME).then(e=>{e.put(t,i)}),r}).catch(()=>caches.match('/')})),t.destination||t.url.includes('/api/')||'image'===t.destination||e.respondWith(caches.match(t).then(r=>r||fetch(t).then(r=>{if(!r)return r;const a=r.clone();return caches.open(CACHE_NAME).then(e=>{e.put(t,a)}),r}))))});
